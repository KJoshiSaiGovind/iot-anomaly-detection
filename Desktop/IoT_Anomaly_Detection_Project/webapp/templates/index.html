<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>IoT Anomaly Detection System</title>

    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">

    <link href="https://fonts.googleapis.com/css2?family=Share+Tech+Mono&display=swap" rel="stylesheet">
</head>

<body>

<div class="container">

    <div class="card">

        <h1>IoT Security Monitoring System</h1>

        <p class="subtitle">
            Real-Time Threat Detection Console
        </p>

        <!-- Upload Form -->
        <form method="POST" enctype="multipart/form-data" onsubmit="showPopup()">

            <div class="file-box">

                <input type="file" name="file" id="file" required onchange="showFileName()">

                <label for="file">Select Dataset</label>

                <p id="file-name">No file selected</p>

            </div>

            <button type="submit">Analyze Network</button>

        </form>

        <!-- Error Message -->
        {% if error %}
        <div class="error-box">
            {{ error }}
        </div>
        {% endif %}

        <!-- Results -->
        {% if result %}

        <div class="result-box">

            <h2>Threat Analysis Report</h2>

            <div class="stats">

                <div class="stat">
                    <span>Total Records</span>
                    <h3>{{ result.total }}</h3>
                </div>

                <div class="stat normal">
                    <span>Normal</span>
                    <h3>{{ result.normal }}</h3>
                </div>

                <div class="stat anomaly">
                    <span>Threats</span>
                    <h3>{{ result.anomalies }}</h3>
                </div>

            </div>

            <p class="threshold">
                Detection Threshold: {{ result.threshold }}
            </p>

        </div>

        <!-- Table -->
        {% if result.rows %}

        <div class="result-box">

            <h2>Detected Threat Records</h2>

            <div class="table-box">

                <table>

                    <thead>
                        <tr>
                            {% for key in result.rows[0].keys() %}
                                <th>{{ key }}</th>
                            {% endfor %}
                        </tr>
                    </thead>

                    <tbody>
                        {% for row in result.rows %}
                        <tr>
                            {% for val in row.values() %}
                                <td>{{ val }}</td>
                            {% endfor %}
                        </tr>
                        {% endfor %}
                    </tbody>

                </table>

            </div>

        </div>

        {% endif %}

        {% endif %}

    </div>

</div>

<!-- Upload Popup -->
<div id="popup" class="popup">
    Dataset Uploaded Successfully!
</div>

<footer>
    Â© 2026 | Cyber Threat Intelligence System
</footer>


<!-- JS -->
<script>

function showFileName() {
    const fileInput = document.getElementById("file");
    const fileName = document.getElementById("file-name");

    if (fileInput.files.length > 0) {
        fileName.innerText = "Selected: " + fileInput.files[0].name;
    }
}

function showPopup() {

    const popup = document.getElementById("popup");

    popup.classList.add("show");

    setTimeout(() => {
        popup.classList.remove("show");
    }, 2000);
}

</script>

</body>
</html>
